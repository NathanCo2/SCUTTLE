<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SCUTTLE: src/Core/Src/task4.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Krabby Logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">SCUTTLE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_a2f0e5642e47e7ed59fe0f0829eafb5f.html">Core</a></li><li class="navelem"><a class="el" href="dir_98d33a86cef786dafad53fd2007ffe4c.html">Src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">task4.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Task 4: Metal Detector.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="task4_8h_source.html">task4.h</a>&quot;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &quot;<a class="el" href="_counter_8h_source.html">Counter.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9ee1914aa0340c48f8db9a74a1e10a80" id="r_a9ee1914aa0340c48f8db9a74a1e10a80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9ee1914aa0340c48f8db9a74a1e10a80">task4_run</a> (uint8_t *State, uint8_t *<a class="el" href="main_8c.html#a25deb8e1618f786bc16b2d959b980839">MDON</a>, uint32_t *<a class="el" href="main_8c.html#a1ccc2e6addda333d9269ca68059aaaea">sumval</a>, <a class="el" href="struct_t_i_m___handle_type_def.html">TIM_HandleTypeDef</a> Timer, uint8_t *<a class="el" href="main_8c.html#a6bc2ffdcd82ea08dbc034eacbde34801">Metal_Found</a>, <a class="el" href="struct_a_d_c___handle_type_def.html">ADC_HandleTypeDef</a> Analog1, <a class="el" href="struct_a_d_c___handle_type_def.html">ADC_HandleTypeDef</a> Analog2, <a class="el" href="struct_a_d_c___handle_type_def.html">ADC_HandleTypeDef</a> Analog3)</td></tr>
<tr class="memdesc:a9ee1914aa0340c48f8db9a74a1e10a80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task 4 state machine: Metal Detector.  <br /></td></tr>
<tr class="separator:a9ee1914aa0340c48f8db9a74a1e10a80"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:abfd71761a6b1360dabc57c127d2c1c9d" id="r_abfd71761a6b1360dabc57c127d2c1c9d"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abfd71761a6b1360dabc57c127d2c1c9d">base</a> = 0</td></tr>
<tr class="memdesc:abfd71761a6b1360dabc57c127d2c1c9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjustable base value to compare to metal detector measurement.  <br /></td></tr>
<tr class="separator:abfd71761a6b1360dabc57c127d2c1c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcab2d4ced5d4c6571db3ff33e235289" id="r_abcab2d4ced5d4c6571db3ff33e235289"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abcab2d4ced5d4c6571db3ff33e235289">Countdown_Start</a> = 0</td></tr>
<tr class="memdesc:abcab2d4ced5d4c6571db3ff33e235289"><td class="mdescLeft">&#160;</td><td class="mdescRight">Signifies time before next metal detection.  <br /></td></tr>
<tr class="separator:abcab2d4ced5d4c6571db3ff33e235289"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a273183ccb480aebdfef8a714dcf6332d" id="r_a273183ccb480aebdfef8a714dcf6332d"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a273183ccb480aebdfef8a714dcf6332d">Countdown_Time</a></td></tr>
<tr class="memdesc:a273183ccb480aebdfef8a714dcf6332d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Countdown time for metal detection.  <br /></td></tr>
<tr class="separator:a273183ccb480aebdfef8a714dcf6332d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3e8526bc4900549ce098f9cabbff074" id="r_aa3e8526bc4900549ce098f9cabbff074"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3e8526bc4900549ce098f9cabbff074">val</a> [9]</td></tr>
<tr class="memdesc:aa3e8526bc4900549ce098f9cabbff074"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array to store ADC values.  <br /></td></tr>
<tr class="separator:aa3e8526bc4900549ce098f9cabbff074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5481714541dff99ddd9e3f7bfec32c3" id="r_aa5481714541dff99ddd9e3f7bfec32c3"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa5481714541dff99ddd9e3f7bfec32c3">impuls</a> = 120</td></tr>
<tr class="memdesc:aa5481714541dff99ddd9e3f7bfec32c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Impulse microsecond delay, fixed value.  <br /></td></tr>
<tr class="separator:aa5481714541dff99ddd9e3f7bfec32c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a474e1a6d040f85996d17d923800459cf" id="r_a474e1a6d040f85996d17d923800459cf"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a474e1a6d040f85996d17d923800459cf">Delay_MD</a></td></tr>
<tr class="memdesc:a474e1a6d040f85996d17d923800459cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjustable delay for Metal Detector.  <br /></td></tr>
<tr class="separator:a474e1a6d040f85996d17d923800459cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb559820d9ca11295b4500f179ef6392" id="r_acb559820d9ca11295b4500f179ef6392"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb559820d9ca11295b4500f179ef6392">i</a></td></tr>
<tr class="separator:acb559820d9ca11295b4500f179ef6392"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Task 4: Metal Detector. </p>
<p>This file contains the implementation for the metal detector. Quick pulses are sent and the resulting analog voltage reading is measured and compared to an adjustable base value. The delay between pulses is also adjustable. </p><dl class="section date"><dt>Date</dt><dd>June 8, 2024 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>tawel </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a9ee1914aa0340c48f8db9a74a1e10a80" name="a9ee1914aa0340c48f8db9a74a1e10a80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ee1914aa0340c48f8db9a74a1e10a80">&#9670;&#160;</a></span>task4_run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void task4_run </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>State</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>MDON</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *</td>          <td class="paramname"><span class="paramname"><em>sumval</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_t_i_m___handle_type_def.html">TIM_HandleTypeDef</a></td>          <td class="paramname"><span class="paramname"><em>Timer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>Metal_Found</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_a_d_c___handle_type_def.html">ADC_HandleTypeDef</a></td>          <td class="paramname"><span class="paramname"><em>Analog1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_a_d_c___handle_type_def.html">ADC_HandleTypeDef</a></td>          <td class="paramname"><span class="paramname"><em>Analog2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_a_d_c___handle_type_def.html">ADC_HandleTypeDef</a></td>          <td class="paramname"><span class="paramname"><em>Analog3</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Task 4 state machine: Metal Detector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">State</td><td>Pointer to the state variable. </td></tr>
    <tr><td class="paramname">MDON</td><td>Pointer to the Metal Detector ON status flag. </td></tr>
    <tr><td class="paramname">sumval</td><td>Pointer to the summed ADC values, which functions as measure of certainty of metal detected. </td></tr>
    <tr><td class="paramname">Timer</td><td>Timer handle for delay functions. (Now Deprecated) </td></tr>
    <tr><td class="paramname">Metal_Found</td><td>Pointer to the metal found status flag. </td></tr>
    <tr><td class="paramname">Analog1</td><td>ADC handle for the first ADC channel. </td></tr>
    <tr><td class="paramname">Analog2</td><td>ADC handle for the second ADC channel. </td></tr>
    <tr><td class="paramname">Analog3</td><td>ADC handle for the third ADC channel. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="abfd71761a6b1360dabc57c127d2c1c9d" name="abfd71761a6b1360dabc57c127d2c1c9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfd71761a6b1360dabc57c127d2c1c9d">&#9670;&#160;</a></span>base</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t base = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjustable base value to compare to metal detector measurement. </p>

</div>
</div>
<a id="abcab2d4ced5d4c6571db3ff33e235289" name="abcab2d4ced5d4c6571db3ff33e235289"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcab2d4ced5d4c6571db3ff33e235289">&#9670;&#160;</a></span>Countdown_Start</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t Countdown_Start = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Signifies time before next metal detection. </p>

</div>
</div>
<a id="a273183ccb480aebdfef8a714dcf6332d" name="a273183ccb480aebdfef8a714dcf6332d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a273183ccb480aebdfef8a714dcf6332d">&#9670;&#160;</a></span>Countdown_Time</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t Countdown_Time</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Countdown time for metal detection. </p>

</div>
</div>
<a id="a474e1a6d040f85996d17d923800459cf" name="a474e1a6d040f85996d17d923800459cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a474e1a6d040f85996d17d923800459cf">&#9670;&#160;</a></span>Delay_MD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t Delay_MD</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjustable delay for Metal Detector. </p>

</div>
</div>
<a id="acb559820d9ca11295b4500f179ef6392" name="acb559820d9ca11295b4500f179ef6392"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb559820d9ca11295b4500f179ef6392">&#9670;&#160;</a></span>i</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int i</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa5481714541dff99ddd9e3f7bfec32c3" name="aa5481714541dff99ddd9e3f7bfec32c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5481714541dff99ddd9e3f7bfec32c3">&#9670;&#160;</a></span>impuls</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t impuls = 120</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Impulse microsecond delay, fixed value. </p>

</div>
</div>
<a id="aa3e8526bc4900549ce098f9cabbff074" name="aa3e8526bc4900549ce098f9cabbff074"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3e8526bc4900549ce098f9cabbff074">&#9670;&#160;</a></span>val</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t val[9]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Array to store ADC values. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
